---
description: As a client side-protection
---

# Setup Git-Secrets

## Installing git-secrets (DSP Endpoints)

For DSP endpoints it is important to enforce a centrally managed and consistent set of patterns that are managed by the DSP AppSec team.

1. git-secrets will be automatically installed on your machine.
2. New Hire Onboarding setup and will be made available by BITS through the Jamf endpoint management system.

Here's a quick example of how to ensure a git repository is scanned for secrets on each commit:

```
cd /path/to/my/repo
git secrets --scan
```

If there are no hooks in your local repositories, follow these steps:

```
git secrets --install ~/.git-templates/git-secrets
git config --global init.templateDir ~/.git-templates/git-secrets
```

### Ignoring False Positives

Sometimes a regular expression might match false positives. For example, git commit SHAs look a lot like AWS access keys. You can specify many different regular expression patterns as false positives using the following command:

```
git secrets --add --allowed 'my_allowed_pattern' --global
```

Configuring allowed patterns allows you to minimize the noise generated by git-secrets during commit checks.

By default your git secrets configuration looks like the following:

```
secrets.providers git secrets --aws-provider
secrets.patterns (A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}
secrets.patterns ("|')?(AWS|aws|Aws)?_?(SECRET|secret|Secret)?_?(ACCESS|access|Access)?_?(KEY|key|Key)("|')?\s*(:|=>|=)\s*("|')?[A-Za-z0-9/\+=]{40}("|')?
secrets.patterns ("|')?(AWS|aws|Aws)?_?(ACCOUNT|account|Account)_?(ID|id|Id)?("|')?\s*(:|=>|=)\s*("|')?[0-9]{4}\-?[0-9]{4}\-?[0-9]{4}("|')?
secrets.allowed AKIAIOSFODNN7EXAMPLE
secrets.allowed wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
secrets.patterns (xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})
secrets.patterns [-]----BEGIN\sRSA\sPRIVATE\sKEY-----
secrets.patterns [-]----BEGIN\sDSA\sPRIVATE\sKEY-----
secrets.patterns [-]----BEGIN\sEC\sPRIVATE\sKEY-----
secrets.patterns [-]----BEGIN\sPGP\sPRIVATE\sKEY\sBLOCK-----
secrets.patterns [f|F][a|A][c|C][e|E][b|B][o|O][o|O][k|K].*['|"][0-9a-f]{32}['|"]
secrets.patterns [g|G][i|I][t|T][h|H][u|U][b|B].*['|"][0-9a-zA-Z]{35,40}['|"]
secrets.patterns AIza[_0-9A-Za-z-]{35}
secrets.patterns ("type":\s"service_account"|"privateKeyType":\s"TYPE_GOOGLE_CREDENTIALS_FILE",)
secrets.patterns ya29\.[_0-9A-Za-z-]+
secrets.patterns [h|H][e|E][r|R][o|O][k|K][u|U].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}
secrets.patterns sk_live_[0-9a-z]{32}
secrets.patterns https://hooks.slack.com/services/T_0-9A-Za-z{8}/B_0-9A-Za-z{8}/_0-9A-Za-z{24}
secrets.patterns sk_live_[0-9a-zA-Z]{24}
secrets.patterns rk_live_[0-9a-zA-Z]{24}
secrets.patterns sq0atp-[_0-9A-Za-z-]{22}
secrets.patterns sq0csp-[_0-9A-Za-z-]{43}
secrets.patterns SK[0-9a-fA-F]{32}
secrets.patterns [t|T][w|W][i|I][t|T][t|T][e|E][r|R].*[1-9][0-9]+-[0-9a-zA-Z]{40}
secrets.patterns [t|T][w|W][i|I][t|T][t|T][e|E][r|R].*['|"][0-9a-zA-Z]{35,44}['|"]
```

After you add an allowed pattern **globally** it will look as following. Note the allowed pattern at the end of the file.

```
secrets.providers git secrets --aws-provider
secrets.patterns (A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}
secrets.patterns ("|')?(AWS|aws|Aws)?_?(SECRET|secret|Secret)?_?(ACCESS|access|Access)?_?(KEY|key|Key)("|')?\s*(:|=>|=)\s*("|')?[A-Za-z0-9/\+=]{40}("|')?
secrets.patterns ("|')?(AWS|aws|Aws)?_?(ACCOUNT|account|Account)_?(ID|id|Id)?("|')?\s*(:|=>|=)\s*("|')?[0-9]{4}\-?[0-9]{4}\-?[0-9]{4}("|')?
secrets.allowed AKIAIOSFODNN7EXAMPLE
secrets.allowed wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
secrets.patterns (xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})
secrets.patterns [-]----BEGIN\sRSA\sPRIVATE\sKEY-----
secrets.patterns [-]----BEGIN\sDSA\sPRIVATE\sKEY-----
secrets.patterns [-]----BEGIN\sEC\sPRIVATE\sKEY-----
secrets.patterns [-]----BEGIN\sPGP\sPRIVATE\sKEY\sBLOCK-----
secrets.patterns [f|F][a|A][c|C][e|E][b|B][o|O][o|O][k|K].*['|"][0-9a-f]{32}['|"]
secrets.patterns [g|G][i|I][t|T][h|H][u|U][b|B].*['|"][0-9a-zA-Z]{35,40}['|"]
secrets.patterns AIza[_0-9A-Za-z-]{35}
secrets.patterns ("type":\s"service_account"|"privateKeyType":\s"TYPE_GOOGLE_CREDENTIALS_FILE",)
secrets.patterns ya29\.[_0-9A-Za-z-]+
secrets.patterns [h|H][e|E][r|R][o|O][k|K][u|U].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}
secrets.patterns sk_live_[0-9a-z]{32}
secrets.patterns https://hooks.slack.com/services/T_0-9A-Za-z{8}/B_0-9A-Za-z{8}/_0-9A-Za-z{24}
secrets.patterns sk_live_[0-9a-zA-Z]{24}
secrets.patterns rk_live_[0-9a-zA-Z]{24}
secrets.patterns sq0atp-[_0-9A-Za-z-]{22}
secrets.patterns sq0csp-[_0-9A-Za-z-]{43}
secrets.patterns SK[0-9a-fA-F]{32}
secrets.patterns [t|T][w|W][i|I][t|T][t|T][e|E][r|R].*[1-9][0-9]+-[0-9a-zA-Z]{40}
secrets.patterns [t|T][w|W][i|I][t|T][t|T][e|E][r|R].*['|"][0-9a-zA-Z]{35,44}['|"]

secrets.allowed my_allowed_pattern
```
